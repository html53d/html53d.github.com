(function(){Browser.Features.Touch=(function(){try{document.createEvent("TouchEvent").initTouchEvent("touchstart");return true;}catch(B){}return false;}());var A=this.ThumbStrip=new Class({Implements:[Events,Options],Binds:["enterThumb","leaveThumb","enter","leave"],options:{srcElements:"li",srcAttribute:"class",rotationDelay:10000},name:"ThumbStrip",currentIndex:0,rotationId:null,rotationActive:false,initialize:function(C,B){this.element=C=$(C);if(!C){return false;}this.setOptions(B);this.buildData();
this.attach();},buildData:function(){this.sources=this.element.getElements(this.options.srcElements);this.data=this.sources.map(function(B){var C=B.getJSONData(this.options.srcAttribute);C.element=B;return C;},this);return this;}.protect(),attach:function(){var D={mouseenter:"enterThumb",mouseleave:"leaveThumb"},B={mouseenter:this.enter,mouseleave:this.leave},C;if(Browser.Features.Touch){D.click="enterThumb";}for(C in D){if(D.hasOwnProperty(C)){B[C+":relay("+this.options.srcElements+")"]=this[D[C]];
}}this.element.addEvents(B);},enterThumb:function(C,B){this.fireEvent("enterThumb",arguments);return this;},leaveThumb:function(C,B){this.fireEvent("leaveThumb",arguments);return this;},enter:function(B){this.stopRotation();this.fireEvent("enter",arguments);return this;},leave:function(B){this.startRotation();this.fireEvent("leave",arguments);return this;},startRotation:function(){this.rotationActive=true;clearTimeout(this.rotationId);this.rotationId=(function(){var B=++this.currentIndex;this.enterThumb(null,this.sources[B%this.sources.length],0);
this.startRotation();}).delay(this.options.rotationDelay,this);return this;},stopRotation:function(){this.rotationActive=false;clearTimeout(this.rotationId);return this;}});}());var TopSlot=new Class({Implements:[Events,Options],Extends:ThumbStrip,Binds:["enterThumb","leaveThumb","enter","leave","showPointer","hidePointer"],options:{onComplete:function(){this.element.fade("in");},srcElements:"ol > li",titleElement:"div.title",deckElement:"div.deck",template:"li.slotTemplate",injectPoint:"ul.slots",currentClass:"current",previousClass:"prev",slotClass:"slot",highlighter:".highlighter",highlightPoint:"span.point",pointerTween:{property:"margin-right",show:-6,hide:0},placeholders:{title:"div.titlePlaceholder",deck:"div.deckPlaceholder"},updateMap:{"a.imageLink":{href:"imgGoToURI"},"img.topslotBg":{src:"bigImage"}},startIndex:0,showDelay:100,BGElement:"div.bg",BGOpacity:0.75},name:"TopSlot",prev:null,timerId:null,initialize:function(B,A){this.element=B=$(B);
if(!B){return false;}this.setOptions(A);this.parent(B,A);this.setHighlighterPos(this.getPosition(this.options.startIndex));this.enterThumb(null,this.sources[this.options.startIndex],0);this.startRotation();this.fireEvent("complete");},buildData:function(){this.parent();var A=this.data.length;while(A--){this.data[A].title=this.data[A].element.getElement(this.options.titleElement).dispose();this.data[A].deck=this.data[A].element.getElement(this.options.deckElement).dispose();}}.protect(),getTemplate:function(){if(!this.template){var A=this.element.getElement(this.options.template);
A&&A.erase("class").addClass(this.options.slotClass).dispose();this.template=A;}return this.template;},getSlot:function(A){return this.data[A].slot||this.buildSlot(A).getSlot(A);},buildSlot:function(C){var E=this.getTemplate(),G=E.clone(),F=this.data[C],B=this.options.placeholders,A=this.options.updateMap;if(Browser.Engine.trident&&Browser.version<=8){var D=G.getElement(this.options.BGElement);if(D){D.setStyle("opacity",this.options.BGOpacity);}}G.addClass((F.isVertBG||F.isVertBG==="true")?"vertical":"horizontal").set("tween",{link:"cancel",duration:250});
Object.each(B,function(I,H){F[H].replaces(G.getElement(I));});Object.each(A,function(L,K){var J=G.getElement(K);if(!J){return false;}var I={},H=0;Object.each(L,function(O,N){var M=F[O];if(M){I[N]=M;H++;}});if(H){J.setProperties(I);}});F.slot=G;return this;}.protect(),getInjectPoint:function(){return this.injectPoint||(this.injectPoint=this.element.getElement(this.options.injectPoint));},getPosition:function(A){var B=this.data[A];return B.pos||(B.pos=B.element.getPosition(this.element));},getPointer:function(){if(!this.pointer){var A=this.element.getElement(this.options.highlightPoint);
A&&A.set("tween",{duration:125,transition:Fx.Transitions.linear});this.pointer=A;}return this.pointer;},showPointer:function(){var B=this.getPointer();if(B){var A=this.options.pointerTween;B.tween(A.property,A.show);}return this;},hidePointer:function(){var C=this.getPointer();if(C){var B=this.options.pointerTween,A=C.get("tween");A.cancel().set(B.property,B.hide);}return this;},getHighlighter:function(){if(!this.highlighter){var A=this.element.getElement(this.options.highlighter);A&&A.set("morph",{duration:250,onStart:this.hidePointer,onComplete:this.showPointer});
this.highlighter=A;}return this.highlighter;},setHighlighterPos:function(A){this.getHighlighter().setPosition(A);},moveHighlighter:function(D){var A={},C=["x","y"],B={x:"left",y:"top"};C.each(function(E){if(D[E]!==undefined){A[B[E]]=D[E];}});this.getHighlighter().morph(A);return this;},enterThumb:function(G,C,B){if(G){G.preventDefault();}var A=this.sources.indexOf(C),F=this.data[A],H=this.getSlot(A),E=this.getInjectPoint(),D=this.prev;this.currentIndex=A;(this.rotationActive)&&this.stopRotation();
clearTimeout(this.timerId);this.timerId=(function(){if(D!==H){if(!F.injected){E.adopt(H);F.injected=true;}this.moveHighlighter(this.getPosition(A));H.addClass(this.options.currentClass).removeClass(this.options.previousClass).get("tween").clearChain().cancel();H.fade("show");if(D){D.addClass(this.options.previousClass).removeClass(this.options.currentClass).get("tween").clearChain().chain(function(){D.removeClass(this.options.previousClass);}.bind(this));D.fade("out");}this.prev=H;this.currentIndex=A;
}}).delay((B!==undefined)?B:this.options.showDelay,this);return this.parent.call(this,G,C,A);},leaveThumb:function(B,A){return this.parent(arguments);}});window.addEvent("domready",function(){var A=$("topslot");A.get("tween").chain(function(){A.addClass("js_on");var B=new TopSlot(A);}).start("opacity",0);});